// Generated by Melange

import * as Caml_option from "melange.js/caml_option.js";
import * as Curry from "melange.js/curry.js";
import * as ReasonReactRouter from "reason-react/ReasonReactRouter.js";
import * as Routes from "../../lib/routes/browser/routes.js";
import * as Stdlib__Array from "melange/array.js";
import * as Stdlib__List from "melange/list.js";
import * as React from "react";
import * as Client from "react-dom/client";
import * as JsxRuntime from "react/jsx-runtime";

function usePathname(param) {
  var url = ReasonReactRouter.useUrl(undefined, undefined);
  var path = url.path;
  if (path) {
    return Stdlib__List.fold_left((function (acc, v) {
                  return acc + ("/" + v);
                }), "", path);
  } else {
    return "/";
  }
}

function Playground_react$Link(Props) {
  var href = Props.href;
  var children = Props.children;
  var style = Props.style;
  var tmp = {
    children: children,
    href: href,
    onClick: (function ($$event) {
        $$event.preventDefault();
        ReasonReactRouter.push(href);
      })
  };
  if (style !== undefined) {
    tmp.style = Caml_option.valFromOption(style);
  }
  return JsxRuntime.jsx("a", tmp);
}

var Link = {
  make: Playground_react$Link
};

function home(param) {
  return Routes.nil;
}

function projects(param) {
  return Routes.$slash$question((function (param) {
                return Routes.s("projects", param);
              }), Routes.wildcard);
}

function siteExplorer(param) {
  return Routes.$slash$question((function (param) {
                return Routes.s("site-explorer", param);
              }), Routes.nil);
}

var router = Routes.one_of({
      hd: Routes.$at$neg$neg$great(Routes.nil, /* Home */0),
      tl: {
        hd: Routes.$at$neg$neg$great(Routes.$slash$question((function (param) {
                    return Routes.s("projects", param);
                  }), Routes.wildcard), (function (param) {
                return /* Projects */1;
              })),
        tl: {
          hd: Routes.$at$neg$neg$great(Routes.$slash$question((function (param) {
                      return Routes.s("site-explorer", param);
                    }), Routes.nil), /* SiteExplorer */2),
          tl: /* [] */0
        }
      }
    });

function href(route) {
  switch (route) {
    case /* Home */0 :
        return Routes.sprintf(Routes.nil);
    case /* Projects */1 :
        return Curry._1(Routes.sprintf(Routes.$slash$question((function (param) {
                              return Routes.s("projects", param);
                            }), Routes.wildcard)), Routes.Parts.of_parts(""));
    case /* SiteExplorer */2 :
        return Routes.sprintf(Routes.$slash$question((function (param) {
                          return Routes.s("site-explorer", param);
                        }), Routes.nil));
    
  }
}

var Root_router = {
  home: home,
  projects: projects,
  siteExplorer: siteExplorer,
  router: router,
  href: href
};

function home$1(param) {
  return Routes.nil;
}

function project_id(param) {
  return Routes.$slash$question(Routes.$$int, Routes.nil);
}

var router$1 = Routes.one_of({
      hd: Routes.$at$neg$neg$great(Routes.nil, /* Home */0),
      tl: {
        hd: Routes.$at$neg$neg$great(Routes.$slash$question(Routes.$$int, Routes.nil), (function (id) {
                return /* Project_id */{
                        id: id
                      };
              })),
        tl: /* [] */0
      }
    });

function href$1(route) {
  var prefix = href(/* Projects */1);
  if (route) {
    return prefix + Curry._1(Routes.sprintf(Routes.$slash$question(Routes.$$int, Routes.nil)), route.id);
  } else {
    return prefix + Routes.sprintf(Routes.nil);
  }
}

var Projects_router = {
  home: home$1,
  project_id: project_id,
  router: router$1,
  href: href$1
};

function tasks(param) {
  return Routes.$slash$question((function (param) {
                return Routes.s("tasks", param);
              }), Routes.nil);
}

function milestones(param) {
  return Routes.$slash$question((function (param) {
                return Routes.s("milestones", param);
              }), Routes.nil);
}

var router$2 = Routes.one_of({
      hd: Routes.$at$neg$neg$great(Routes.$slash$question((function (param) {
                  return Routes.s("tasks", param);
                }), Routes.nil), /* Tasks */0),
      tl: {
        hd: Routes.$at$neg$neg$great(Routes.$slash$question((function (param) {
                    return Routes.s("milestones", param);
                  }), Routes.nil), /* Milestones */1),
        tl: /* [] */0
      }
    });

function href$2(id, route) {
  var prefix = href$1(/* Project_id */{
        id: id
      });
  if (route) {
    return prefix + Routes.sprintf(Routes.$slash$question((function (param) {
                      return Routes.s("milestones", param);
                    }), Routes.nil));
  } else {
    return prefix + Routes.sprintf(Routes.$slash$question((function (param) {
                      return Routes.s("tasks", param);
                    }), Routes.nil));
  }
}

var Project_detail_router = {
  tasks: tasks,
  milestones: milestones,
  router: router$2,
  href: href$2
};

function handle(route) {
  if (route) {
    return JsxRuntime.jsx("div", {
                children: "Milestones"
              });
  } else {
    return JsxRuntime.jsx("div", {
                children: "Tasks"
              });
  }
}

function Playground_react$Project_detail(Props) {
  var target = Props.target;
  var match = Routes.match$p(router$2, target);
  if (typeof match === "number") {
    return JsxRuntime.jsx("div", {
                children: " Project_detail Not Found"
              });
  } else {
    return handle(match._0);
  }
}

var Project_detail = {
  handle: handle,
  make: Playground_react$Project_detail
};

function Playground_react$Projects_home(Props) {
  return React.createElement(JsxRuntime.Fragment, undefined, Stdlib__Array.map((function (id) {
                    var idStr = String(id);
                    return JsxRuntime.jsx("div", {
                                children: JsxRuntime.jsx(Playground_react$Link, {
                                      href: href$1(/* Project_id */{
                                            id: id
                                          }),
                                      children: "Projects " + idStr
                                    })
                              }, idStr);
                  }), [
                  1,
                  2,
                  3
                ]));
}

var Projects_home = {
  make: Playground_react$Projects_home
};

function handle$1(route, rest) {
  if (!route) {
    return JsxRuntime.jsx(Playground_react$Projects_home, {});
  }
  var id = route.id;
  var tmp = rest === "" ? null : JsxRuntime.jsx(Playground_react$Project_detail, {
          target: rest
        });
  return React.createElement(JsxRuntime.Fragment, undefined, JsxRuntime.jsx("h2", {
                  children: "Projects with id = " + String(id)
                }), JsxRuntime.jsx("div", {
                  children: JsxRuntime.jsx(Playground_react$Link, {
                        href: href$2(id, /* Tasks */0),
                        children: "Tasks"
                      })
                }), JsxRuntime.jsx(Playground_react$Link, {
                  href: href$2(id, /* Milestones */1),
                  children: "Milestones"
                }), tmp);
}

function Playground_react$Projects(Props) {
  var target = Props.target;
  var pathname = usePathname(undefined);
  var match = Routes.match$p(router$1, target);
  if (typeof match === "number") {
    return JsxRuntime.jsx("div", {
                children: " Project_router Not Found"
              });
  }
  var route = match._0;
  var matchedHref = href$1(route);
  var rest = pathname.replace(matchedHref, "");
  return handle$1(route, rest);
}

var Projects = {
  handle: handle$1,
  make: Playground_react$Projects
};

function handle$2(route, rest) {
  switch (route) {
    case /* Home */0 :
        return JsxRuntime.jsx("h1", {
                    children: "Home"
                  });
    case /* Projects */1 :
        return React.createElement(JsxRuntime.Fragment, undefined, JsxRuntime.jsx("h1", {
                        children: "Projects"
                      }), JsxRuntime.jsx(Playground_react$Projects, {
                        target: rest
                      }));
    case /* SiteExplorer */2 :
        return JsxRuntime.jsx("h1", {
                    children: "SiteExplorer"
                  });
    
  }
}

function Playground_react$Root(Props) {
  var pathname = usePathname(undefined);
  var match = Routes.match$p(router, pathname);
  if (typeof match === "number") {
    return JsxRuntime.jsx("div", {
                children: "Root_router Not Found"
              });
  }
  var route = match._0;
  var matchedHref = href(route);
  var rest = pathname.replace(matchedHref, "");
  return handle$2(route, rest);
}

var Root = {
  handle: handle$2,
  make: Playground_react$Root
};

var Client$1 = {};

function Playground_react$App(Props) {
  return JsxRuntime.jsxs("header", {
              children: [
                JsxRuntime.jsx("div", {
                      children: JsxRuntime.jsxs("nav", {
                            children: [
                              JsxRuntime.jsx(Playground_react$Link, {
                                    href: Routes.sprintf(Routes.nil),
                                    children: "Home"
                                  }),
                              JsxRuntime.jsx(Playground_react$Link, {
                                    href: href(/* Projects */1),
                                    children: "Projects",
                                    style: {
                                      marginLeft: "24px"
                                    }
                                  }),
                              JsxRuntime.jsx(Playground_react$Link, {
                                    href: href(/* SiteExplorer */2),
                                    children: "Site Explorer",
                                    style: {
                                      marginLeft: "24px"
                                    }
                                  })
                            ],
                            style: {
                              display: "flex",
                              alignItems: "center"
                            }
                          }),
                      style: {
                        padding: "4px 5px"
                      }
                    }),
                JsxRuntime.jsx("main", {
                      children: JsxRuntime.jsx(Playground_react$Root, {})
                    })
              ]
            });
}

var App = {
  make: Playground_react$App
};

var node = document.querySelector("#root");

if (node == null) {
  console.error("Failed to start React: couldn't find the #root element");
} else {
  Client.createRoot(node).render(JsxRuntime.jsx(React.StrictMode, {
            children: JsxRuntime.jsx(Playground_react$App, {})
          }));
}

var node$1 = (node == null) ? undefined : Caml_option.some(node);

export {
  usePathname ,
  Link ,
  Root_router ,
  Projects_router ,
  Project_detail_router ,
  Project_detail ,
  Projects_home ,
  Projects ,
  Root ,
  Client$1 as Client,
  App ,
  node$1 as node,
}
/* router Not a pure module */
